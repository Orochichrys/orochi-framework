const SAFE_VALUE_RE=/^[0-9a-zA-Z\s\-\_\#\.\%\(\)\[\]\{\}\:;\/\+\>\<\=\'\",@]+$/i,ARB_CLASS_RE=/(^|\s)([a-zA-Z0-9\-\_:]+)\[([^\]]+)\]/g,DEFAULT_MAP={bg:(e,r)=>({property:"background",value:e}),text:(e,r)=>({property:"color",value:e}),radius:(e,r)=>({property:"border-radius",value:e}),w:(e,r)=>({property:"width",value:e}),h:(e,r)=>({property:"height",value:e}),p:(e,r)=>({property:"padding",value:e}),pt:(e,r)=>({property:"padding-top",value:e}),pr:(e,r)=>({property:"padding-right",value:e}),pb:(e,r)=>({property:"padding-bottom",value:e}),pl:(e,r)=>({property:"padding-left",value:e}),m:(e,r)=>({property:"margin",value:e}),mt:(e,r)=>({property:"margin-top",value:e}),mr:(e,r)=>({property:"margin-right",value:e}),mb:(e,r)=>({property:"margin-bottom",value:e}),ml:(e,r)=>({property:"margin-left",value:e}),shadow:(e,r)=>({property:"box-shadow",value:e})};function safeValue(e){if(null==e)return null;const r=String(e).trim();if(!r)return null;if(!SAFE_VALUE_RE.test(r))return null;const t=r.toLowerCase();return t.includes("expression(")||t.includes("javascript:")?null:r}function normalizePrefix(e){if(!e)return e;let r=String(e).trim();if(r=r.replace(/^[\-\_]+/,""),r=r.replace(/[\-\_]+$/,""),r=r.replace(/[_]+/g,"-").replace(/-+/g,"-"),r.includes(":")){const e=r.split(":");r=e[e.length-1]}return r}function parseAndApply(e){if(!e||!e.className)return;const r=e.className;let t;for(;null!==(t=ARB_CLASS_RE.exec(r));){const r=t[2],o=safeValue(t[3]);if(!o)continue;const s=normalizePrefix(r),l=OrochiJIT.handlers[s];if(l)try{const r=l(o,e);r&&r.property?e.style.setProperty(r.property,r.value):"object"==typeof r&&(r.property&&r.value?e.style.setProperty(r.property,r.value):Object.entries(r).forEach((([r,t])=>e.style.setProperty(r,t))))}catch(e){console.warn("OrochiJIT handler error",e)}else{const r=s.replace(/[:_]/g,"-");e.style.setProperty(r,o)}}}function applyTokenClasses(e){e&&e.classList&&(e.classList.contains("text-white")&&e.style.setProperty("color","#fff"),e.classList.contains("text-black")&&e.style.setProperty("color","#000"))}const OrochiJIT={handlers:{},addHandler(e,r){if(!e||"function"!=typeof r)throw new Error("Invalid handler");this.handlers[e]=r},processElement(e){if(!e||!e.className)return;(-1!==e.className.indexOf("[")||e.classList.contains("text-white")||e.classList.contains("text-black"))&&(parseAndApply(e),applyTokenClasses(e))},processRoot(e=document){const r='[class*="["]';e instanceof Element?(e.className&&-1!==e.className.indexOf("[")&&this.processElement(e),e.querySelectorAll&&e.querySelectorAll(r).forEach((e=>this.processElement(e)))):document.querySelectorAll&&document.querySelectorAll(r).forEach((e=>this.processElement(e)))}};Object.entries(DEFAULT_MAP).forEach((([e,r])=>OrochiJIT.addHandler(e,r))),OrochiJIT.addHandler("bg-",DEFAULT_MAP.bg),OrochiJIT.addHandler("radius-",DEFAULT_MAP.radius);const observer=new MutationObserver((e=>{for(const r of e)"attributes"===r.type&&"class"===r.attributeName&&r.target&&OrochiJIT.processElement(r.target),r.addedNodes&&r.addedNodes.length&&r.addedNodes.forEach((e=>{1===e.nodeType&&(e.className&&-1!==e.className.indexOf("[")&&OrochiJIT.processElement(e),e.querySelectorAll&&e.querySelectorAll('[class*="["]').forEach((e=>OrochiJIT.processElement(e))))}))}));document.addEventListener("DOMContentLoaded",(()=>{OrochiJIT.processRoot(document),observer.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})),window.OrochiJIT=OrochiJIT;